<h2>DESCRIPTION</h2>
This module is designed to apply a user defined Python function (UDF) to
aggregate a time series into a single output raster map.
<p>
The user defined function must be named <i>udf_time_series_to_raster_map</i>
to be used in this module. The argument of this function is a dictionary that contains
the name of the STRDS, the start- and end-time arrays of type <i>pandas.DatetimeIndex</i> and
the three dimensional cell array. The dictionary is created using the following function:
<p>

<div class="code"><pre>

def create_udf_ts_tile_object(identifier, cell_array, start_time, end_time=None):
    """Create a time series object for a user defined function

    :param identifier: The identifier of the time series, in GRASS GIS is would be
                       the STRDS name
    :param cell_array: A three dimensional cell array. For each time stamp a two dimensional
                       slice of cell values is provided.
                       - First (0) dimension is time, time stamps are located in separate arrays
                       - Second (1) dimension is y
                       - Third (2) dimension is x
    :param start_time: A pandas.DatetimeIndex object that includes the start-time-stamps
                       of the first dimension of the cell array
    :param end_time: A pandas.DatetimeIndex object that includes the end-time-stamps
                       of the first dimension of the cell array

    The provided data will be put into a dictionary that has the following layout:

    .. code: Python
    {
        "identifier":identifier,
        "cell_array":cell_array,
        "start_time":start_time,
        "end_time":end_time
    }

    :return: A dictionary that contains the time series tile
    """

    data_object = {}
    data_object["identifier"] = identifier
    data_object["cell_array"] = cell_array
    data_object["start_time"] = start_time
    data_object["end_time"] = end_time

    return data_object
</pre></div>

<H2>EXAMPLES</H2>

Compute the sum of all slices in the time series cube along the time axis (0):

<div class="code"><pre>
import numpy as np
def udf_time_series_to_raster_map(t):
    return np.sum(t["cell_array"], axis=0)
</pre></div>

Compute the sum of all slices in the time series cube along the time axis (0)
and divide the sum by the number of days in which the time series is valid:

<div class="code"><pre>
import numpy as np
def udf_time_series_to_raster_map(t):
    if t["end_time"] is not None:
        td = t["end_time"][-1] - t["start_time"][0]
    else:
        td = t["start_time"][-1] - t["start_time"][0]

    return np.sum(t["cell_array"], axis=0)/td.days
</pre></div>


<h2>AUTHOR</h2>

S&ouml;ren Gebbert

<p><i>Last changed: $Date: 2016-09-19 12:29:41 +0200 (Mo, 19. Sep 2016) $</i>
